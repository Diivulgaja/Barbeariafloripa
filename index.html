<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ilha Cuts | Barbearia Premium</title>
    
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- Babel para JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Supabase SDK -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        amber: { 400: '#fbbf24', 500: '#f59e0b', 600: '#d97706' },
                        zinc: { 800: '#27272a', 900: '#18181b', 950: '#09090b' }
                    },
                    fontFamily: { sans: ['Inter', 'sans-serif'] },
                    animation: { 'spin-slow': 'spin 3s linear infinite' }
                }
            }
        }
    </script>

    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">

    <style>
        body { font-family: 'Inter', sans-serif; background-color: #000; }
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #09090b; }
        ::-webkit-scrollbar-thumb { background: #27272a; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #f59e0b; }
        
        .glass { background: rgba(24, 24, 27, 0.6); backdrop-filter: blur(12px); border: 1px solid rgba(255, 255, 255, 0.05); }
        .animate-slide-up { animation: slideUp 0.8s ease-out forwards; }
        .animate-fade-in { animation: fadeIn 0.5s ease-out forwards; }
        @keyframes slideUp { from { opacity:0; transform:translateY(30px); } to { opacity:1; transform:translateY(0); } }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        @keyframes float { 0%, 100% { transform: translateY(0px) rotate(3deg); } 50% { transform: translateY(-20px) rotate(3deg); } }
        .animate-float { animation: float 6s ease-in-out infinite; }
        .animate-slow-zoom { animation: slow-zoom 20s linear infinite alternate; }
        @keyframes slow-zoom { 0% { transform: scale(1); } 100% { transform: scale(1.1); } }
    </style>
</head>
<body class="bg-black text-zinc-200 antialiased selection:bg-amber-500 selection:text-black overflow-x-hidden">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useMemo, useRef } = React;
        
        // --- SUPABASE CONFIG ---
        const supabaseUrl = 'https://aqxwkrgmmomlhbvbolld.supabase.co'; 
        const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImFxeHdrcmdtbW9tbGhidmJvbGxkIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjkzOTI5MTYsImV4cCI6MjA4NDk2ODkxNn0.dx61Nka8dKdozydNAps6KKMzNr1qEBJWF19GENEkpTc';
        
        let sbClient = null;
        try { 
            if (window.supabase) sbClient = window.supabase.createClient(supabaseUrl, supabaseKey);
        } catch (e) { console.error("Supabase Init Error:", e); }

        // --- ICONS (SVG Inline) ---
        const Icon = ({ path, size = 24, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className} dangerouslySetInnerHTML={{ __html: path }} />
        );
        const icons = {
            scissors: '<circle cx="6" cy="6" r="3"/><circle cx="6" cy="18" r="3"/><line x1="20" x2="8.12" y1="4" y2="15.88"/><line x1="14.47" x2="20" y1="14.48" y2="20"/><line x1="8.12" x2="12" y1="8.12" y2="12"/>',
            calendar: '<rect width="18" height="18" x="3" y="4" rx="2" ry="2"/><line x1="16" x2="16" y1="2" y2="6"/><line x1="8" x2="8" y1="2" y2="6"/><line x1="3" x2="21" y1="10" y2="10"/>',
            clock: '<circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/>',
            mapPin: '<path d="M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z"/><circle cx="12" cy="10" r="3"/>',
            user: '<path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/>',
            check: '<path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/>',
            menu: '<line x1="4" x2="20" y1="12" y2="12"/><line x1="4" x2="20" y1="6" y2="6"/><line x1="4" x2="20" y1="18" y2="18"/>',
            x: '<path d="M18 6 6 18"/><path d="m6 6 12 12"/>',
            star: '<polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/>',
            dollar: '<line x1="12" x2="12" y1="2" y2="22"/><path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/>',
            users: '<path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M22 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/>',
            logOut: '<path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/><polyline points="16 17 21 12 16 7"/><line x1="21" x2="9" y1="12" y2="12"/>',
            dashboard: '<rect width="7" height="9" x="3" y="3" rx="1"/><rect width="7" height="5" x="14" y="3" rx="1"/><rect width="7" height="9" x="14" y="12" rx="1"/><rect width="7" height="5" x="3" y="16" rx="1"/>',
            settings: '<path d="M12.22 2h-.44a2 2 0 0 1-2-1.08l-.58-1.28a2 2 0 0 0-3.18-.53l-1 .85a2 2 0 0 1-2.26.23l-1.3-.8a2 2 0 0 0-2.88 1.48l-.13 1.34a2 2 0 0 1-1.63 1.83l-1.35.25a2 2 0 0 0-1.4 2.8l.94 1a2 2 0 0 1 .46 2.22l-.78 1.15a2 2 0 0 0 1.25 3l1.32.17a2 2 0 0 1 1.85 1.41l.46 1.3a2 2 0 0 0 2.93 1l1.1-.73a2 2 0 0 1 2.22.13l1.23.83a2 2 0 0 0 3-.97l.34-1.29a2 2 0 0 1 2.07-1.46l1.33-.08a2 2 0 0 0 2.15-2.6l-.8-1.13a2 2 0 0 1-.28-2.3l1-1.05a2 2 0 0 0-.6-3l-1.32-.42a2 2 0 0 1-1.63-1.8l.12-1.37a2 2 0 0 0-1.87-2.67l-1.22.42a2 2 0 0 1-2.2-.67l-.23-1.36A2 2 0 0 0 12.22 2z"/><circle cx="12" cy="12" r="3"/>',
            phone: '<path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"/>',
            instagram: '<rect width="20" height="20" x="2" y="2" rx="5" ry="5"/><path d="M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z"/><line x1="17.5" x2="17.51" y1="6.5" y2="6.5"/>',
            zap: '<polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/>',
            arrowRight: '<path d="M5 12h14"/><path d="m12 5 7 7-7 7"/>',
            barChart: '<path d="M3 3v18h18"/><path d="M18 17V9"/><path d="M13 17V5"/><path d="M8 17v-3"/>',
            bell: '<path d="M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9"/><path d="M10.3 21a1.94 1.94 0 0 0 3.4 0"/>',
            trash: '<polyline points="3 6 5 6 21 6"/><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/><line x1="10" x2="10" y1="11" y2="17"/><line x1="14" x2="14" y1="11" y2="17"/>',
            plus: '<line x1="12" x2="12" y1="5" y2="19"/><line x1="5" x2="19" y1="12" y2="12"/>'
        };

        // --- BUSINESS DATA ---
        const BUSINESS = {
            name: "ILHA CUTS",
            address: "Rua Bocaiúva, 1234, Centro - Floripa",
            phone: "(48) 99999-9999",
            map: "https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3536.275841643477!2d-48.54960302359744!3d-27.58503892804535!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x9527382046429357%3A0x6e257211516f1c4e!2sBeiramar%20Shopping!5e0!3m2!1spt-BR!2sbr"
        };

        const SERVICES_DEFAULT = [
            { id: 1, name: "Corte Signature", price: 75, duration: 45, desc_text: "Consultoria visual completa e corte." },
            { id: 2, name: "Barba Real", price: 55, duration: 30, desc_text: "Toalha quente e óleos essenciais." },
            { id: 3, name: "Combo Ilha", price: 110, duration: 80, desc_text: "Experiência completa cabelo e barba." },
            { id: 4, name: "Camuflagem", price: 45, duration: 30, desc_text: "Disfarce natural de fios brancos." }
        ];

        const STAFF_DEFAULT = [
            { id: 1, name: "João 'Navalha'", role: "Master Barber", rating: 5.0, image: "JN", desc_text: "15 anos de tradição." },
            { id: 2, name: "Pedro 'Fade'", role: "Expert", rating: 4.9, image: "PF", desc_text: "Mestre em degradês modernos." },
            { id: 3, name: "Lucas 'Classic'", role: "Barber", rating: 4.8, image: "LC", desc_text: "Especialista em tesoura." }
        ];

        const GALLERY = [
            "https://images.unsplash.com/photo-1599351431202-1e0f0137899a?q=80&w=800&auto=format&fit=crop",
            "https://images.unsplash.com/photo-1622286342621-4bd786c2447c?q=80&w=800&auto=format&fit=crop",
            "https://images.unsplash.com/photo-1532710093739-9470acff878f?q=80&w=800&auto=format&fit=crop",
            "https://images.unsplash.com/photo-1503951914875-452162b7f30a?q=80&w=800&auto=format&fit=crop"
        ];

        const fmtMoney = (v) => new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' }).format(v);

        // --- HELPERS ---
        const scrollToSection = (id) => {
            const el = document.getElementById(id);
            if (el) el.scrollIntoView({ behavior: 'smooth' });
        };

        const useScrollSpy = () => {
            const [scrolled, setScrolled] = useState(false);
            useEffect(() => {
                const handler = () => setScrolled(window.scrollY > 20);
                window.addEventListener('scroll', handler);
                return () => window.removeEventListener('scroll', handler);
            }, []);
            return scrolled;
        };

        // --- UI COMPONENTS ---
        const GlassCard = ({ children, className = '', hoverEffect = true }) => (
            <div className={`relative overflow-hidden bg-zinc-900/60 backdrop-blur-md border border-white/5 p-6 rounded-2xl ${hoverEffect ? 'transition-all duration-500 hover:bg-zinc-800/80 hover:border-amber-500/30 hover:shadow-2xl hover:shadow-amber-500/10 hover:-translate-y-1' : ''} ${className}`}>
                {children}
            </div>
        );

        const SectionHeader = ({ title, subtitle, centered = true }) => (
            <div className={`mb-16 ${centered ? 'text-center' : ''} animate-slide-up`}>
                <h2 className="text-4xl md:text-5xl font-bold text-white mb-4 tracking-tight">
                    {title.split(' ').map((w, i) => <span key={i} className={i === 1 ? "text-transparent bg-clip-text bg-gradient-to-r from-amber-400 to-amber-600" : ""}>{w} </span>)}
                </h2>
                <div className={`h-1 w-24 bg-amber-500 rounded-full mb-6 ${centered ? 'mx-auto' : ''}`} />
                {subtitle && <p className="text-zinc-400 text-lg max-w-2xl mx-auto leading-relaxed">{subtitle}</p>}
            </div>
        );

        const Button = ({ children, onClick, icon, disabled, className = '', variant = 'primary' }) => {
            const base = "relative overflow-hidden font-bold py-3 px-8 rounded-xl transition-all duration-300 active:scale-95 disabled:opacity-50 flex items-center justify-center gap-2";
            const style = variant === 'primary' 
                ? "bg-gradient-to-r from-amber-500 to-amber-600 text-black hover:shadow-[0_0_20px_rgba(245,158,11,0.4)]" 
                : "border border-zinc-700 hover:bg-zinc-800 text-white";
            return (
                <button onClick={onClick} disabled={disabled} className={`${base} ${style} ${className}`}>
                    {children} {icon && <Icon path={icons[icon]} size={20} />}
                </button>
            );
        };

        // --- FEATURE COMPONENTS ---
        const Navbar = ({ onViewChange, currentView, scrolled, onOpenBooking }) => {
            const [mobileOpen, setMobileOpen] = useState(false);

            return (
                <nav className={`fixed top-0 inset-x-0 z-50 transition-all duration-500 ${scrolled ? 'py-4 bg-black/90 backdrop-blur-xl border-b border-white/5 shadow-2xl' : 'py-6 bg-transparent'}`}>
                    <div className="container mx-auto px-6 flex justify-between items-center relative">
                        <div onClick={() => onViewChange('home')} className="flex items-center gap-3 cursor-pointer group z-50">
                            <div className="w-10 h-10 bg-gradient-to-br from-amber-400 to-amber-600 rounded-lg flex items-center justify-center text-black shadow-lg shadow-amber-500/20 group-hover:rotate-12 transition-transform"><Icon path={icons.scissors} /></div>
                            <div><h1 className="text-xl font-bold text-white leading-none tracking-wider">ILHA<span className="text-amber-500">CUTS</span></h1><span className="text-[10px] text-zinc-400 uppercase tracking-[0.3em] font-semibold">Premium</span></div>
                        </div>
                        
                        <div className="hidden md:flex items-center gap-8">
                            {['Serviços', 'Equipa', 'Galeria', 'Local'].map(i => (
                                <button key={i} onClick={() => scrollToSection(i.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g, ""))} className="text-sm font-bold text-zinc-400 hover:text-white uppercase tracking-widest transition-colors">{i}</button>
                            ))}
                            {currentView === 'admin' ? 
                                <button onClick={() => onViewChange('home')} className="text-red-500 text-xs font-bold uppercase border border-red-900/50 px-4 py-2 rounded-lg hover:bg-red-900/20 transition-all">Sair Admin</button> :
                                <div className="flex items-center gap-4">
                                    <button onClick={() => onViewChange('admin')} className="text-zinc-600 hover:text-white transition-colors" title="Admin"><Icon path={icons.settings} size={20}/></button>
                                    <Button onClick={onOpenBooking} className="!py-2 !px-6 text-xs uppercase tracking-widest">Agendar</Button>
                                </div>
                            }
                        </div>

                        <button className="md:hidden text-white p-2 z-50" onClick={() => setMobileOpen(!mobileOpen)}>
                            <Icon path={mobileOpen ? icons.x : icons.menu} />
                        </button>

                        {mobileOpen && (
                            <div className="absolute top-full left-0 w-full bg-zinc-950 border-b border-zinc-800 p-6 flex flex-col gap-4 animate-fade-in md:hidden shadow-2xl">
                                {['Serviços', 'Equipa', 'Galeria', 'Local'].map(i => (
                                    <button key={i} onClick={() => { scrollToSection(i.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g, "")); setMobileOpen(false); }} className="text-left text-zinc-300 hover:text-white py-2 border-b border-zinc-900">{i}</button>
                                ))}
                                <Button onClick={() => { onOpenBooking(); setMobileOpen(false); }} className="w-full mt-2">Agendar Agora</Button>
                                <button onClick={() => { onViewChange('admin'); setMobileOpen(false); }} className="text-xs text-zinc-600 text-center mt-4">Acesso Administrativo</button>
                            </div>
                        )}
                    </div>
                </nav>
            );
        }

        const Hero = ({ onCta }) => (
            <section className="relative min-h-screen flex items-center pt-20 overflow-hidden">
                <div className="absolute inset-0 z-0">
                    <img src="https://images.unsplash.com/photo-1503951914875-452162b7f30a?q=80&w=2070&auto=format&fit=crop" className="w-full h-full object-cover opacity-30 scale-105 animate-slow-zoom"/>
                    <div className="absolute inset-0 bg-gradient-to-r from-black via-black/90 to-transparent" />
                    <div className="absolute inset-0 bg-gradient-to-t from-black via-transparent to-black/40" />
                </div>
                <div className="container mx-auto px-6 relative z-10 grid lg:grid-cols-2 gap-12 items-center">
                    <div className="space-y-8 animate-slide-up max-w-2xl">
                        <div className="inline-flex items-center gap-2 px-4 py-2 rounded-full border border-amber-500/30 bg-amber-500/10 text-amber-500 text-xs font-bold tracking-widest uppercase backdrop-blur-md"><Icon path={icons.star} size={12}/> A melhor da Ilha</div>
                        <h1 className="text-6xl md:text-8xl font-bold text-white leading-[1.1] tracking-tight">Sua Imagem, <br/><span className="text-transparent bg-clip-text bg-gradient-to-r from-amber-400 to-amber-700">Nosso Legado.</span></h1>
                        <p className="text-zinc-400 text-lg md:text-xl max-w-lg leading-relaxed border-l-4 border-amber-500 pl-6">Não é apenas um corte. É um ritual de cavalheiros. Experimente a barbearia que redefiniu o conceito de estilo em Florianópolis.</p>
                        <div className="flex flex-col sm:flex-row gap-4 pt-4">
                            <Button onClick={onCta} icon="calendar" className="text-lg">Agendar Horário</Button>
                            <button onClick={() => scrollToSection('galeria')} className="px-8 py-4 rounded-xl border border-white/10 text-white font-bold hover:bg-white/5 transition-all flex items-center justify-center gap-2 group"><Icon path={icons.zap} size={20} className="text-amber-500 group-hover:scale-110 transition-transform"/> Ver Galeria</button>
                        </div>
                    </div>
                    <div className="hidden lg:block relative animate-float">
                        <GlassCard className="rotate-3 max-w-sm ml-auto border-amber-500/20 bg-black/60 backdrop-blur-2xl">
                            <div className="flex justify-between items-start mb-6">
                                <div><p className="text-amber-500 text-xs font-bold uppercase tracking-widest mb-1">Próximo Horário</p><h3 className="text-3xl font-bold text-white">Hoje, 14:00</h3></div>
                                <div className="p-4 bg-gradient-to-br from-amber-400 to-amber-600 rounded-xl text-black shadow-lg shadow-amber-500/20"><Icon path={icons.scissors} size={28}/></div>
                            </div>
                            <div className="space-y-6">
                                <div><div className="flex justify-between text-xs text-zinc-400 mb-2"><span>Disponibilidade</span><span>3 Barbeiros</span></div><div className="h-2 bg-zinc-800 rounded-full overflow-hidden"><div className="h-full w-3/4 bg-amber-500 animate-pulse" /></div></div>
                                <button onClick={onCta} className="w-full py-4 rounded-xl bg-zinc-800 hover:bg-zinc-700 text-white text-sm font-bold transition-colors border border-zinc-700 hover:border-amber-500/50 flex justify-center items-center gap-2">Reservar Agora <Icon path={icons.arrowRight} size={16}/></button>
                            </div>
                        </GlassCard>
                    </div>
                </div>
            </section>
        );

        const Features = ({ services }) => (
            <section id="servicos" className="py-32 bg-black relative">
                <div className="container mx-auto px-6">
                    <SectionHeader title="Experiência Premium" subtitle="Técnicas clássicas combinadas com produtos de alta performance." />
                    <div className="grid md:grid-cols-2 lg:grid-cols-4 gap-6">
                        {services.length > 0 ? services.map((s) => (
                            <GlassCard key={s.id} className="group">
                                <div className="flex justify-between items-start mb-8">
                                    <div className="w-14 h-14 rounded-2xl bg-zinc-800/50 flex items-center justify-center text-amber-500 group-hover:bg-amber-500 group-hover:text-black transition-all duration-500"><Icon path={icons.scissors} size={28}/></div>
                                    <span className="text-2xl font-bold text-white tracking-tight">{fmtMoney(s.price)}</span>
                                </div>
                                <h3 className="text-xl font-bold text-white mb-3 group-hover:text-amber-500 transition-colors">{s.name}</h3>
                                <p className="text-zinc-400 text-sm leading-relaxed mb-6 line-clamp-2">{s.desc_text}</p>
                                <div className="flex items-center gap-2 text-xs text-zinc-500 font-bold uppercase tracking-wider"><Icon path={icons.clock} size={14} className="text-amber-500"/> {s.duration} min</div>
                            </GlassCard>
                        )) : <div className="col-span-4 text-center text-zinc-500">Carregando serviços...</div>}
                    </div>
                </div>
            </section>
        );

        const Team = ({ staff }) => (
            <section id="equipa" className="py-32 bg-zinc-950 relative border-y border-zinc-900">
                <div className="container mx-auto px-6 relative z-10">
                    <SectionHeader title="Mestres da Navalha" subtitle="Profissionais escolhidos a dedo para garantir a sua melhor versão." />
                    <div className="grid md:grid-cols-3 gap-8">
                        {staff.length > 0 ? staff.map(s => (
                            <div key={s.id} className="group relative h-96 rounded-2xl overflow-hidden bg-zinc-900 border border-zinc-800">
                                <div className="absolute inset-0 flex items-center justify-center text-zinc-800 font-bold text-9xl opacity-20 group-hover:scale-110 transition-transform duration-700">{s.image}</div>
                                <div className="absolute inset-0 bg-gradient-to-t from-black via-black/50 to-transparent flex flex-col justify-end p-8">
                                    <h3 className="text-2xl font-bold text-white mb-1">{s.name}</h3>
                                    <p className="text-amber-500 text-sm font-bold uppercase tracking-widest mb-4">{s.role}</p>
                                    <p className="text-zinc-400 text-sm mb-6 opacity-0 group-hover:opacity-100 transition-opacity transform translate-y-4 group-hover:translate-y-0 duration-500">{s.desc_text}</p>
                                    <div className="flex items-center gap-1 text-amber-400 text-sm"><Icon path={icons.star} size={16}/> {s.rating}/5.0</div>
                                </div>
                            </div>
                        )) : <div className="col-span-3 text-center text-zinc-500">Carregando equipe...</div>}
                    </div>
                </div>
            </section>
        );

        const Gallery = () => (
            <section id="galeria" className="py-32 bg-black">
                <div className="container mx-auto px-6">
                    <SectionHeader title="Nossa Arte" subtitle="Confira alguns dos nossos trabalhos recentes." />
                    <div className="grid grid-cols-2 md:grid-cols-4 gap-4">
                        {GALLERY.map((src, i) => (
                            <div key={i} className={`rounded-xl overflow-hidden h-64 relative group cursor-pointer border border-zinc-800 ${i === 0 ? 'md:col-span-2 md:row-span-2 md:h-[33rem]' : ''}`}>
                                <img src={src} className="w-full h-full object-cover group-hover:scale-110 transition-transform duration-700" alt="Corte" />
                                <div className="absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center"><Icon path={icons.instagram} className="text-white w-10 h-10" /></div>
                            </div>
                        ))}
                    </div>
                </div>
            </section>
        );

        const BookingModal = ({ isOpen, onClose, onConfirm, isSaving, services, staff }) => {
            const [step, setStep] = useState(1);
            const [form, setForm] = useState({ service: null, barber: null, date: '', time: '', clientName: '', clientPhone: '' });
            
            const isStepValid = () => {
                if(step === 1) return !!form.service;
                if(step === 2) return !!form.barber;
                if(step === 3) return !!form.date && !!form.time;
                if(step === 4) return !!form.clientName && !!form.clientPhone;
                return false;
            };

            if (!isOpen) return null;
            const next = (k, v) => { 
                if(k) setForm(p => ({...p, [k]: v})); 
                setStep(s => s + 1); 
            };

            return (
                <div className="fixed inset-0 z-[60] flex items-center justify-center bg-black/90 backdrop-blur-sm animate-fade-in p-4">
                    <div className="w-full max-w-5xl h-[90vh] md:h-auto bg-zinc-950 border border-zinc-800 rounded-3xl shadow-2xl overflow-hidden flex flex-col md:flex-row relative">
                        <button onClick={onClose} className="absolute top-4 right-4 text-zinc-500 hover:text-white z-50"><Icon path={icons.x} /></button>
                        <div className="w-full md:w-1/3 bg-zinc-900/50 p-8 border-b md:border-b-0 md:border-r border-zinc-800 flex flex-col justify-between">
                            <div>
                                <h3 className="text-2xl font-bold text-white mb-8">Agendamento</h3>
                                <div className="space-y-6">
                                    {[{l:"Serviço", i:'scissors'}, {l:"Barbeiro", i:'user'}, {l:"Data", i:'calendar'}, {l:"Confirmar", i:'check'}].map((s, i) => (
                                        <div key={i} className={`flex items-center gap-4 transition-opacity ${step === i + 1 ? 'opacity-100' : 'opacity-40'}`}>
                                            <div className={`w-10 h-10 rounded-full flex items-center justify-center border ${step > i + 1 ? 'bg-amber-500 border-amber-500 text-black' : 'border-zinc-700 text-zinc-400'}`}>{step > i + 1 ? <Icon path={icons.check} size={16}/> : <Icon path={icons[s.i]} size={16}/>}</div>
                                            <span className="text-sm font-bold text-zinc-300">{s.l}</span>
                                        </div>
                                    ))}
                                </div>
                            </div>
                            <div className="mt-8 p-4 bg-zinc-900 rounded-xl border border-zinc-800"><p className="text-xs text-zinc-500 uppercase tracking-wider mb-1">Total Estimado</p><p className="text-2xl font-bold text-white">{form.service ? fmtMoney(form.service.price) : 'R$ 0,00'}</p></div>
                        </div>
                        <div className="flex-1 p-8 md:p-12 overflow-y-auto bg-zinc-950">
                            {step === 1 && (
                                <div className="animate-slide-up space-y-4">
                                    <h4 className="text-2xl font-bold text-white mb-6">Escolha o tratamento</h4>
                                    {services.length > 0 ? services.map(s => (
                                        <button key={s.id} onClick={() => next('service', s)} className="w-full text-left p-5 rounded-xl border border-zinc-800 bg-zinc-900/50 hover:border-amber-500 hover:bg-zinc-900 transition-all group flex justify-between items-center">
                                            <div><div className="font-bold text-white group-hover:text-amber-500">{s.name}</div><div className="text-xs text-zinc-500">{s.duration} min • {s.desc_text}</div></div><div className="text-amber-500 font-bold">{fmtMoney(s.price)}</div>
                                        </button>
                                    )) : <p className="text-zinc-500">Carregando serviços...</p>}
                                </div>
                            )}
                            {step === 2 && (
                                <div className="animate-slide-up">
                                    <h4 className="text-2xl font-bold text-white mb-6">Selecione o profissional</h4>
                                    <div className="grid grid-cols-2 gap-4">
                                        {staff.length > 0 ? staff.map(s => (
                                            <button key={s.id} onClick={() => next('barber', s)} className="p-6 rounded-xl border border-zinc-800 bg-zinc-900/50 hover:border-amber-500 hover:bg-zinc-900 transition-all group flex flex-col items-center gap-4">
                                                <div className="w-16 h-16 rounded-full bg-zinc-800 border-2 border-zinc-700 flex items-center justify-center text-xl font-bold text-zinc-500 group-hover:border-amber-500 group-hover:text-white transition-colors">{s.image}</div>
                                                <div className="text-center"><div className="font-bold text-white">{s.name}</div><div className="text-xs text-zinc-500">{s.role}</div></div>
                                            </button>
                                        )) : <p className="text-zinc-500 col-span-2 text-center">Carregando equipe...</p>}
                                    </div>
                                </div>
                            )}
                            {step === 3 && (
                                <div className="animate-slide-up space-y-6">
                                    <h4 className="text-2xl font-bold text-white">Escolha data e hora</h4>
                                    <input type="date" className="w-full bg-zinc-900 border border-zinc-800 rounded-xl p-4 text-white focus:border-amber-500 outline-none" onChange={e => setForm(prev => ({...prev, date: e.target.value}))} />
                                    <div className="grid grid-cols-3 gap-3">
                                        {["09:00","10:00","11:00","14:00","15:00","16:00","17:00","18:00","19:00"].map(t => (
                                            <button key={t} onClick={() => next('time', t)} disabled={!form.date} className="py-3 rounded-lg border border-zinc-800 bg-zinc-900/50 hover:bg-amber-500 hover:text-black text-white disabled:opacity-30 disabled:cursor-not-allowed font-medium transition-colors">{t}</button>
                                        ))}
                                    </div>
                                </div>
                            )}
                            {step === 4 && (
                                <div className="animate-slide-up h-full flex flex-col">
                                    <h4 className="text-2xl font-bold text-white mb-6">Finalizar Agendamento</h4>
                                    <div className="bg-zinc-900/50 p-6 rounded-xl border border-zinc-800 mb-6 space-y-4">
                                        <div className="flex justify-between border-b border-zinc-800 pb-4"><div><span className="text-xs text-zinc-500 uppercase">Serviço</span><div className="font-bold text-white">{form.service?.name}</div></div><div className="text-right"><span className="text-xs text-zinc-500 uppercase">Valor</span><div className="font-bold text-amber-500">{fmtMoney(form.service?.price)}</div></div></div>
                                        <div className="flex items-center gap-3"><div className="w-8 h-8 rounded-full bg-zinc-800 flex items-center justify-center text-xs text-zinc-400 font-bold">{form.barber?.image}</div><div><div className="text-sm font-bold text-white">{form.barber?.name}</div><div className="text-xs text-zinc-500">{form.date} às {form.time}</div></div></div>
                                    </div>
                                    <div className="space-y-4 mb-6">
                                        <input type="text" placeholder="Seu Nome Completo" className="w-full bg-transparent border-b border-zinc-700 py-3 text-white outline-none focus:border-amber-500 transition-colors" value={form.clientName} onChange={e => setForm(prev => ({...prev, clientName: e.target.value}))} />
                                        <input type="tel" placeholder="Seu WhatsApp" className="w-full bg-transparent border-b border-zinc-700 py-3 text-white outline-none focus:border-amber-500 transition-colors" value={form.clientPhone} onChange={e => setForm(prev => ({...prev, clientPhone: e.target.value}))} />
                                    </div>
                                    <div className="mt-auto">
                                        <Button onClick={() => onConfirm(form)} disabled={isSaving || !isStepValid()} className="w-full" icon={isSaving ? null : 'check'}>{isSaving ? "Confirmando..." : "Confirmar Agendamento"}</Button>
                                        <button onClick={() => setStep(3)} className="w-full mt-4 text-sm text-zinc-500 hover:text-white">Voltar e corrigir</button>
                                    </div>
                                </div>
                            )}
                        </div>
                    </div>
                </div>
            );
        };

        const AdminPanel = ({ appointments = [], services = [], staff = [], onUpdateStatus, onAddService, onDeleteService }) => {
            const [activeTab, setActiveTab] = useState('dashboard');
            const [newService, setNewService] = useState({ name: '', price: '', duration: '', desc_text: '' });

            const revenue = appointments.filter(a => a.status === 'completed' || a.status === 'confirmed').reduce((acc, curr) => acc + (curr.service?.price || 0), 0);
            const uniqueClients = Array.from(new Set(appointments.map(a => a.client_phone))).map(phone => appointments.find(a => a.client_phone === phone));

            const handleAddService = (e) => {
                e.preventDefault();
                onAddService({ ...newService, price: parseFloat(newService.price), duration: parseInt(newService.duration) });
                setNewService({ name: '', price: '', duration: '', desc_text: '' });
            };

            return (
                <div className="min-h-screen bg-black flex text-zinc-200 font-sans">
                    <aside className="w-72 border-r border-zinc-800 bg-zinc-950 p-8 flex flex-col hidden lg:flex">
                        <div className="flex items-center gap-3 mb-12 text-white"><Icon path={icons.scissors} size={28} className="text-amber-500"/><span className="font-bold tracking-widest text-xl">ADMIN</span></div>
                        <nav className="flex-1 space-y-2">
                            {['dashboard', 'agenda', 'servicos', 'clientes'].map(tab => (
                                <button key={tab} onClick={() => setActiveTab(tab)} className={`w-full flex items-center gap-3 px-4 py-3 rounded-lg text-sm font-bold transition-all ${activeTab === tab ? 'bg-amber-500/10 text-amber-500 border border-amber-500/20' : 'text-zinc-400 hover:text-white hover:bg-zinc-900'}`}>
                                    <Icon path={icons[tab === 'servicos' ? 'settings' : tab === 'clientes' ? 'users' : tab === 'agenda' ? 'calendar' : 'dashboard']} size={18}/> {tab.charAt(0).toUpperCase() + tab.slice(1)}
                                </button>
                            ))}
                        </nav>
                    </aside>
                    <main className="flex-1 p-8 lg:p-12 overflow-y-auto">
                        <header className="flex justify-between items-center mb-12"><div><h2 className="text-3xl font-bold text-white mb-2">Painel de Controle</h2><p className="text-zinc-500">Gestão completa via Supabase</p></div><div className="w-10 h-10 rounded-full bg-gradient-to-tr from-amber-500 to-amber-700 border-2 border-zinc-800 shadow-lg"></div></header>
                        
                        {activeTab === 'dashboard' && (
                            <>
                                <div className="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                                    <GlassCard className="!p-6" hoverEffect={false}><div className="flex justify-between items-start mb-4"><div className="p-3 rounded-xl bg-zinc-800 text-green-500 bg-opacity-30"><Icon path={icons.dollar} size={24}/></div></div><h3 className="text-3xl font-bold text-white mb-1">{fmtMoney(revenue)}</h3><p className="text-zinc-500 text-sm font-medium">Receita Estimada</p></GlassCard>
                                    <GlassCard className="!p-6" hoverEffect={false}><div className="flex justify-between items-start mb-4"><div className="p-3 rounded-xl bg-zinc-800 text-blue-500 bg-opacity-30"><Icon path={icons.users} size={24}/></div></div><h3 className="text-3xl font-bold text-white mb-1">{appointments.length}</h3><p className="text-zinc-500 text-sm font-medium">Total de Agendamentos</p></GlassCard>
                                    <GlassCard className="!p-6" hoverEffect={false}><div className="flex justify-between items-start mb-4"><div className="p-3 rounded-xl bg-zinc-800 text-amber-500 bg-opacity-30"><Icon path={icons.star} size={24}/></div></div><h3 className="text-3xl font-bold text-white mb-1">{uniqueClients.length}</h3><p className="text-zinc-500 text-sm font-medium">Clientes Únicos</p></GlassCard>
                                </div>
                            </>
                        )}

                        {activeTab === 'agenda' && (
                            <GlassCard className="!p-0 overflow-hidden" hoverEffect={false}>
                                <div className="p-6 border-b border-zinc-800"><h3 className="font-bold text-white text-lg">Gerenciar Agendamentos</h3></div>
                                <div className="divide-y divide-zinc-800">
                                    {appointments.map((apt) => (
                                        <div key={apt.id} className="p-5 flex items-center justify-between hover:bg-zinc-800/30 transition-colors">
                                            <div className="flex items-center gap-4">
                                                <div className={`w-10 h-10 rounded-full flex items-center justify-center text-sm font-bold border ${apt.status === 'cancelled' ? 'border-red-500 text-red-500' : apt.status === 'completed' ? 'border-green-500 text-green-500' : 'border-amber-500 text-amber-500'}`}>{apt.client_name.substring(0,2).toUpperCase()}</div>
                                                <div><p className="text-white font-bold text-sm">{apt.client_name}</p><p className="text-zinc-500 text-xs">{apt.service?.name} • {apt.date} às {apt.time}</p></div>
                                            </div>
                                            <div className="flex items-center gap-2">
                                                {apt.status === 'confirmed' && (
                                                    <>
                                                        <button onClick={() => onUpdateStatus(apt.id, 'completed')} className="p-2 hover:bg-green-500/20 text-green-500 rounded-lg transition-colors" title="Concluir"><Icon path={icons.check} size={18}/></button>
                                                        <button onClick={() => onUpdateStatus(apt.id, 'cancelled')} className="p-2 hover:bg-red-500/20 text-red-500 rounded-lg transition-colors" title="Cancelar"><Icon path={icons.x} size={18}/></button>
                                                    </>
                                                )}
                                                <span className={`text-xs font-bold px-2 py-1 rounded uppercase ${apt.status === 'confirmed' ? 'bg-amber-500/10 text-amber-500' : apt.status === 'completed' ? 'bg-green-500/10 text-green-500' : 'bg-red-500/10 text-red-500'}`}>{apt.status}</span>
                                            </div>
                                        </div>
                                    ))}
                                    {appointments.length === 0 && <div className="p-8 text-center text-zinc-500">Nenhum agendamento encontrado.</div>}
                                </div>
                            </GlassCard>
                        )}

                        {activeTab === 'servicos' && (
                            <div className="grid grid-cols-1 lg:grid-cols-3 gap-8">
                                <div className="lg:col-span-2 space-y-4">
                                    {services.map(s => (
                                        <div key={s.id} className="bg-zinc-900 border border-zinc-800 p-4 rounded-xl flex justify-between items-center">
                                            <div><h4 className="font-bold text-white">{s.name}</h4><p className="text-zinc-500 text-sm">{s.desc_text}</p><span className="text-amber-500 font-bold text-sm">{fmtMoney(s.price)} • {s.duration} min</span></div>
                                            <button onClick={() => onDeleteService(s.id)} className="text-zinc-600 hover:text-red-500 transition-colors"><Icon path={icons.trash} size={18}/></button>
                                        </div>
                                    ))}
                                    {services.length === 0 && <div className="text-zinc-500 text-center p-4">Nenhum serviço cadastrado.</div>}
                                </div>
                                <div className="bg-zinc-900 border border-zinc-800 p-6 rounded-xl h-fit">
                                    <h4 className="font-bold text-white mb-4">Adicionar Serviço</h4>
                                    <form onSubmit={handleAddService} className="space-y-3">
                                        <input className="w-full bg-black border border-zinc-700 rounded p-2 text-white text-sm" placeholder="Nome" value={newService.name} onChange={e => setNewService({...newService, name: e.target.value})} required/>
                                        <div className="flex gap-2">
                                            <input type="number" className="w-full bg-black border border-zinc-700 rounded p-2 text-white text-sm" placeholder="Preço" value={newService.price} onChange={e => setNewService({...newService, price: e.target.value})} required/>
                                            <input type="number" className="w-full bg-black border border-zinc-700 rounded p-2 text-white text-sm" placeholder="Minutos" value={newService.duration} onChange={e => setNewService({...newService, duration: e.target.value})} required/>
                                        </div>
                                        <input className="w-full bg-black border border-zinc-700 rounded p-2 text-white text-sm" placeholder="Descrição Curta" value={newService.desc_text} onChange={e => setNewService({...newService, desc_text: e.target.value})} />
                                        <button type="submit" className="w-full bg-amber-500 hover:bg-amber-600 text-black font-bold py-2 rounded transition-colors flex justify-center gap-2"><Icon path={icons.plus} size={16}/> Adicionar</button>
                                    </form>
                                </div>
                            </div>
                        )}

                        {activeTab === 'clientes' && (
                            <GlassCard className="!p-0 overflow-hidden" hoverEffect={false}>
                                <div className="p-6 border-b border-zinc-800"><h3 className="font-bold text-white text-lg">Carteira de Clientes</h3></div>
                                <div className="divide-y divide-zinc-800">
                                    {uniqueClients.map((c, i) => (
                                        <div key={i} className="p-5 flex items-center justify-between hover:bg-zinc-800/30">
                                            <div className="flex items-center gap-4">
                                                <div className="w-10 h-10 rounded-full bg-zinc-800 flex items-center justify-center text-zinc-400"><Icon path={icons.user} size={18}/></div>
                                                <div><p className="text-white font-bold">{c.client_name}</p><p className="text-zinc-500 text-xs">{c.client_phone}</p></div>
                                            </div>
                                            <button className="text-amber-500 hover:text-amber-400 text-sm">Ver Histórico</button>
                                        </div>
                                    ))}
                                    {uniqueClients.length === 0 && <div className="p-8 text-center text-zinc-500">Nenhum cliente registrado.</div>}
                                </div>
                            </GlassCard>
                        )}
                    </main>
                </div>
            );
        };

        // --- MAIN APP CONTROLLER ---
        function App() {
            const [view, setView] = useState('home');
            const [scrolled, setScrolled] = useState(false);
            const [bookingOpen, setBookingOpen] = useState(false);
            const [loading, setLoading] = useState(false);
            const [toast, setToast] = useState(null);
            
            // Dados Dinâmicos com Fallback para Default
            const [appointments, setAppointments] = useState([]);
            const [services, setServices] = useState(SERVICES_DEFAULT);
            const [staff, setStaff] = useState(STAFF_DEFAULT);

            useEffect(() => {
                const onScroll = () => setScrolled(window.scrollY > 20);
                window.addEventListener('scroll', onScroll);
                return () => window.removeEventListener('scroll', onScroll);
            }, []);

            const fetchData = async () => {
                if (!sbClient) return;
                
                const { data: apts } = await sbClient.from('appointments').select('*').order('created_at', { ascending: false });
                if (apts) setAppointments(apts);
                
                const { data: servs } = await sbClient.from('services').select('*').order('price', { ascending: true });
                if (servs && servs.length > 0) setServices(servs);

                const { data: stf } = await sbClient.from('staff').select('*');
                if (stf && stf.length > 0) setStaff(stf);
            };

            useEffect(() => {
                fetchData();
                const interval = setInterval(fetchData, 5000); 
                return () => clearInterval(interval);
            }, []);

            const showToast = (title, msg) => {
                setToast({ title, msg });
                setTimeout(() => setToast(null), 4000);
            };

            const handleBooking = async (data) => {
                if (!sbClient) { showToast("Erro Config", "Supabase não conectado."); return; }
                setLoading(true);
                
                let guestId = localStorage.getItem('guest_id');
                if (!guestId) {
                    guestId = 'guest-' + Math.random().toString(36).substr(2, 9);
                    localStorage.setItem('guest_id', guestId);
                }

                const payload = {
                    client_name: data.clientName,
                    client_phone: data.clientPhone,
                    date: data.date,
                    time: data.time,
                    service: data.service,
                    barber: data.barber,
                    status: 'confirmed',
                    user_id: guestId
                };
                
                const { error } = await sbClient.from('appointments').insert([payload]);
                setLoading(false);
                
                if (error) {
                    console.error(error);
                    showToast("Erro", "Falha ao salvar.");
                } else {
                    setBookingOpen(false);
                    showToast("Sucesso!", "Horário agendado com sucesso.");
                    fetchData();
                }
            };

            const handleUpdateStatus = async (id, status) => {
                const { error } = await sbClient.from('appointments').update({ status }).eq('id', id);
                if (!error) {
                    showToast("Atualizado", `Status alterado para ${status}`);
                    fetchData();
                } else {
                    showToast("Erro", "Não foi possível atualizar.");
                }
            };

            const handleAddService = async (serviceData) => {
                const { error } = await sbClient.from('services').insert([serviceData]);
                if (!error) {
                    showToast("Sucesso", "Serviço adicionado.");
                    fetchData();
                } else {
                    console.error(error);
                    showToast("Erro", "Falha ao adicionar serviço.");
                }
            };

            const handleDeleteService = async (id) => {
                if(!confirm("Tem certeza que deseja remover este serviço?")) return;
                const { error } = await sbClient.from('services').delete().eq('id', id);
                if (!error) {
                    showToast("Removido", "Serviço excluído.");
                    fetchData();
                }
            };

            const currentView = () => {
                if (view === 'admin') return (
                    <AdminPanel 
                        appointments={appointments} 
                        services={services} 
                        staff={staff}
                        onUpdateStatus={handleUpdateStatus} 
                        onAddService={handleAddService}
                        onDeleteService={handleDeleteService}
                    />
                );
                return (
                    <main>
                        <Navbar 
                            onViewChange={setView} 
                            currentView={view} 
                            scrolled={scrolled} 
                            onOpenBooking={() => setBookingOpen(true)}
                        />
                        <Hero onCta={() => setBookingOpen(true)} />
                        <Features services={services} />
                        <Team staff={staff} />
                        <Gallery />
                        <footer id="local" className="bg-zinc-950 py-20 border-t border-zinc-900 relative">
                            <div className="absolute top-0 left-1/2 -translate-x-1/2 -translate-y-1/2 bg-zinc-950 p-4 rounded-full border border-zinc-800"><Icon path={icons.scissors} size={32} className="text-amber-500"/></div>
                            <div className="container mx-auto px-6 grid md:grid-cols-4 gap-12">
                                <div className="col-span-2"><h2 className="text-3xl font-bold text-white mb-6">ILHA<span className="text-amber-500">CUTS</span></h2><p className="text-zinc-400 max-w-sm mb-8">A tradição da barbearia clássica com a modernidade que você precisa.</p></div>
                                <div><h4 className="text-white font-bold mb-6 text-lg">Links Rápidos</h4><ul className="space-y-4 text-zinc-400 text-sm">
                                    {['Nossa História', 'Trabalhe Conosco', 'Política de Privacidade'].map(l=><li key={l} className="hover:text-amber-500 cursor-pointer transition-colors" onClick={() => showToast("Info", "Página em construção")}>{l}</li>)}
                                </ul></div>
                                <div><h4 className="text-white font-bold mb-6 text-lg">Onde Estamos</h4><p className="text-xs text-zinc-500 flex items-center gap-2"><Icon path={icons.mapPin} size={14}/> {BUSINESS.address}</p></div>
                            </div>
                        </footer>
                        <BookingModal isOpen={bookingOpen} onClose={() => setBookingOpen(false)} onConfirm={handleBooking} isSaving={loading} services={services} staff={staff} />
                    </main>
                );
            };

            return (
                <div className="text-zinc-200">
                    {currentView()}
                    {toast && (
                        <div className="fixed bottom-6 right-6 z-[100] bg-zinc-900 border border-zinc-800 p-5 rounded-xl shadow-2xl flex items-center gap-4 animate-slide-up border-l-4 border-l-amber-500">
                            <div className="w-10 h-10 rounded-full bg-green-500/10 flex items-center justify-center text-green-500"><Icon path={icons.check} size={20}/></div>
                            <div><h4 className="font-bold text-white text-sm">{toast.title}</h4><p className="text-zinc-400 text-xs">{toast.msg}</p></div>
                        </div>
                    )}
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
